// ---------- ユーザーが「http://」でアクセスしてきたら「https://」にリダイレクトする ------------
if( location.href.substr(0,5) != "https" ){ window.location.href = location.href.replace( /http:/g , "https:" ); }

// ---------- ヴァーチャル洗足ログインクッキーを持っていたら消去
// ---------- 2019.04 バーチャル洗足閉鎖に伴って実行
if( document.cookie.indexOf("SOLS-LOGIN-VS=") != -1 )
{
	console.log("VS cookie stopped working.");
	document.cookie = "SOLS-LOGIN-VS=;		max-age=0";
	document.cookie = "SOLS-VS-UserName=;	max-age=0";
	document.cookie = "SOLS-VS-UserID=;		max-age=0";
	document.cookie = "SOLS-VS-Passwd=;		max-age=0";
}

// ----------googleアナリティクス----------
// (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
// (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
// m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
// })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

// ga('create', 'UA-41537963-1', 'senzoku-online.jp');
// ga('send', 'pageview');

// ----------googleアナリティクス（新）----------
fetch("https://www.googletagmanager.com/gtag/js?id=G-LDX0XZVBE5").then(r=>{return r.text()}).then(t=>{
	eval(t);
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	  
	gtag('config', 'G-LDX0XZVBE5');
	gtag('config', 'UA-41537963-1');		
});

// ---------- ブラウザのオープン ----------
function MM_openBrWindow(theURL,winName,features) { //v2.0
  window.open(theURL,winName,features);
}
// ---------- 画像のプリロード ----------
function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}
// ---------- イメージ変更 ----------
function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}
function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}
// ---------- ページの移動 ----------
function MM_goToURL() { //v3.0
  var i, args=MM_goToURL.arguments; document.MM_returnValue = false;
  for (i=0; i<(args.length-1); i+=2) eval(args[i]+".location='"+args[i+1]+"'");
}
// ---------- Find Object ----------
function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}
// ---------- Set Text ----------
function MM_setTextOfTextfield(objId,x,newText) { //v9.0
  with (document){ if (getElementById){
    var obj = getElementById(objId);} if (obj) obj.value = newText;
  }
}

// ------------------------------------------------------------
// 再生
// ------------------------------------------------------------
// ---------- パーツ再生（mp3） ----------
var sndPRTcondition = "STOP";
var sndPRT;

function playPRT(fn)
{
	var str;
	if( fn.substr(0,2) == "SE" )
	{
		if( sndPRTcondition == "STOP" )
		{
			sndPRTcondition = fn;
			str = "https://www.senzoku-online.jp/PRT/" + fn + ".mp3";
			sndPRT = new Audio(str);
			sndPRT.play();
			sndPRT.addEventListener("ended", endedPRT, false);
		}
		else if( sndPRTcondition == fn )
		{
			sndPRT.pause();
			sndPRT.currentTime = 0;
			sndPRTcondition = "STOP";
		}
	}
	else
	{
		if( sndPRTcondition == fn )
		{
			sndPRT.pause();
			sndPRT.currentTime = 0;
			sndPRTcondition = "STOP";
		}
		else
		{
			sndPRTcondition = fn;
			str = "https://www.senzoku-online.jp/PRT/" + fn + ".mp3";
			sndPRT = new Audio(str);
			sndPRT.play();
			sndPRT.addEventListener("ended", endedPRT, false);
		}
	}
}
function endedPRT()
{
	sndPRTcondition = "STOP";
}
// ---------- 総合音楽講座 音楽再生（mp3） ----------
var sndSTCcondition = "STOP";
var sndSTC;

function playSTC(fn)
{
	var str;
	if( sndSTCcondition == "STOP" )
	{
		str = "https://www.senzoku-online.jp/synthetic_chair/sound/" + fn + ".mp3";
		sndSTC = new Audio(str);
		sndSTC.play();
		sndSTCcondition = "play";
		sndSTC.addEventListener("ended", stopSTC, false);
	}
}
function stopSTC()
{
	sndSTC.pause();
	sndSTCcondition = "STOP";
}
// ------------------------------------------------------------
// 楽譜切り替え
// ------------------------------------------------------------
// ---------- 総合音楽講座  ----------
function scoreChange(num)
{
	switch (num)
	{
		case 1:$(".score1").toggle();break;
		case 2:$(".score2").toggle();break;
	}
}
// ------------------------------------------------------------
// YouTube検索
// ------------------------------------------------------------
function YouTube(keyword)
{
	window.open("https://www.youtube.com/results?search_query=" + encodeURI(keyword), "_blank", "" ,"");
}

// ------------------------------------------------------------
// Ajax（ヴァーチャル洗足のみで使用）
// ------------------------------------------------------------
function createXMLHttpRequest()
{
	// ------------------------------------------------------------
	// 非同期通信を行うためのXMLHttpRequestオブジェクトを生成
	// ------------------------------------------------------------
	if(window.XMLHttpRequest){return new XMLHttpRequest()}
	if(window.ActiveXObject){
			try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}
			try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}
			try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}
	}
	return false;
};

// ------------------------------------------------------------
// 外部リンク
// ------------------------------------------------------------
function linkExternal(acc,url1,url2)
{
	common_dba("WEB_GUEST",acc,url1,url2,window.location.href);
	window.open(url1 + url2,'_blank');
}
function common_dba(V1,V2,V3,V4,V5)
{
	var RN=Math.random()*1000000;
	var TB="history_link_external";
	var DT={"EX":"INS","TB":TB,"PW":"SG","V1":V1,"V2":V2,"V3":V3,"V4":V4,"V5":V5,"RN":RN};
	$.ajax({type:"POST",url:"/dba/dbj.php",data:DT}).done(function(html){$("#DBRES").html(html)}).success(common_dbb());
}
function common_dbb(){}
